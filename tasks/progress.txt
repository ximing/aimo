## Codebase Patterns
- When modifying routes, always update related navigation components (layout.tsx, user-menu.tsx, etc.)
- ProtectedRoute component handles auth redirects automatically
- Auth redirects should go to `/home` for authenticated app entry, `/` for landing page
- The landing page should be in `apps/web/src/pages/landing/`
- Services use `@Service()` decorator from typedi for DI
- Controllers use `@JsonController()` decorator with path prefix
- DTOs should be added to `@aimo/dto` package and exported from index.ts
- Use `undefined` instead of `null` per codebase convention (unicorn/no-null rule)
- Error codes are defined in `apps/server/src/constants/error-codes.ts`
- Use `ErrorCode.SYSTEM_ERROR` for general errors with custom message

## 2026-02-21 - US-001 (创建公开访问的首页路由)
- 创建 LandingPage 组件作为公开首页 (`apps/web/src/pages/landing/`)
- 修改路由配置: `/` 为公开访问的 landing page
- 添加 `/home` 路径作为登录后的主应用入口（需认证）
- 更新登录/已认证用户的重定向目标为 `/home`
- 更新 layout 组件中的首页导航和 active 状态检查 (`isHomePage` 检查改为 `/home`)
- **Files changed:**
  - `apps/web/src/App.tsx` - 添加 LandingPage 路由，/home 需认证
  - `apps/web/src/pages/landing/landing.tsx` - 新建 landing page 组件
  - `apps/web/src/pages/landing/index.tsx` - landing page 导出
  - `apps/web/src/pages/auth/auth.tsx` - 更新已认证重定向到 /home
  - `apps/web/src/pages/auth/components/login-form.tsx` - 更新登录成功重定向到 /home
  - `apps/web/src/components/layout.tsx` - 更新首页导航和 active 状态检查
- **Learnings for future iterations:**
  - 路由变更需要同步更新所有相关组件中的导航逻辑
  - `ProtectedRoute` 会自动处理未认证用户访问 `/home` 的重定向
  - Landing page 使用标准 button 元素，不需要额外的 UI 组件库
  - 需要同时更新 login-form.tsx 和 auth.tsx 中的重定向逻辑
---

## 2026-02-21 - US-010 (GitHub Releases 版本获取服务)
- Created GitHubReleaseService in `apps/server/src/services/github-release.service.ts`
- Implemented 1-hour caching using Map to store version info with timestamps
- Desktop version fetched from `ximing/aimo` GitHub releases
- APK version fetched from `ximing/aimo-app` GitHub releases
- Added public GET `/api/v1/system/app-versions` endpoint (no auth required)
- Added VersionInfoDto and AllVersionsResponseDto to `@aimo/dto` package
- Error handling: returns `{ version: undefined, error?: string }` on failure
- Version tag cleaned up (removes 'v' prefix from GitHub tags)
- **Files changed:**
  - `apps/server/src/services/github-release.service.ts` - New service for GitHub API
  - `apps/server/src/controllers/v1/system.controller.ts` - Added app-versions endpoint
  - `packages/dto/src/version.ts` - New DTO types
  - `packages/dto/src/index.ts` - Export version DTOs
- **Learnings for future iterations:**
  - GitHub API uses `tag_name` for release version, often prefixed with 'v'
  - The codebase prefers `undefined` over `null` (enforced by unicorn/no-null lint rule)
  - When adding DTOs, must rebuild `@aimo/dto` package before typecheck passes
  - Use `ErrorCode` constants from error-codes.ts for consistent error handling
  - Services use TypeDI `@Service()` decorator for dependency injection
  - Controller methods can be public without auth by simply not using `@CurrentUser()`
---
